"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),r=e(t),n=require("@sanity/form-builder/PatchEvent"),i=e(n),a=e(require("config:bynder-input")),o=e(require("part:@sanity/components/buttons/button-grid")),l=e(require("part:@sanity/components/buttons/default")),s=e(require("part:@sanity/components/fieldsets/default")),c=e(require("video.js")),d=require("@sanity/field/diff");function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var u=function(e){var n=t.useRef(null),i=t.useState(),a=i[0],o=i[1];return t.useEffect((function(){return n.current&&o(c(n.current,e)),function(){return null==a?void 0:a.dispose()}}),[n]),r.createElement("div",null,r.createElement("link",{href:"https://vjs.zencdn.net/7.8.4/video-js.css",rel:"stylesheet"}),r.createElement("div",{"data-vjs-player":!0,style:{marginBottom:"16px"}},r.createElement("video",{className:"video-js vjs-16-9 vjs-big-play-centered",ref:n})))};function m(e){var t=e.value;return t&&t.previewUrl?r.createElement("div",null,r.createElement("img",{alt:"preview",src:t.previewUrl,style:{width:"100%"}})):r.createElement("div",{className:'@import "part:@sanity/base/theme/variables-style";.root{display:flex;flex-direction:column;height:100%}.header{flex:1;min-height:0;padding:var(--small-padding) var(--small-padding) 0}.imageWrapper{background-color:color(var(--gray-lightest) alpha(50%));background-image:linear-gradient(45deg,var(--checkerboard-color) 25%,transparent 25%),linear-gradient(-45deg,var(--checkerboard-color) 25%,transparent 25%),linear-gradient(45deg,transparent 75%,var(--checkerboard-color) 75%),linear-gradient(-45deg,transparent 75%,var(--checkerboard-color) 75%);background-position:0 0,0 8px,8px -8px,-8px 0;background-size:16px 16px;display:flex;flex-direction:column;height:100%;max-height:190px;position:relative;&:after{bottom:0;box-shadow:inset 0 0 0 1px var(--hairline-color);content:"";display:block;left:0;pointer-events:none;position:absolute;right:0;top:0}}.image{display:block;flex:1;height:100%;min-height:0;-o-object-fit:contain;object-fit:contain;width:100%;@nest &[data-action="removed"]{opacity:.5}}.error{composes:image;margin:50px 0;text-align:center}.hotspotCrop{display:block;height:100%;left:0;position:absolute;top:0;width:100%}.imageWrapperChanged{composes:imageWrapper;opacity:.45}.strikethrough{text-decoration:line-through}.noImage{composes:small from "part:@sanity/base/theme/typography/text-blocks-style";align-items:center;background:var(--gray-lightest);border-radius:var(--border-radius-small);color:var(--gray-dark);display:flex;height:100%;justify-content:center;width:100%}'.noImage},r.createElement("div",null,"(no image)"))}exports.default={name:"bynder.asset",type:"object",title:"Bynder Asset",fields:[{type:"string",name:"id"},{type:"string",name:"name"},{type:"string",name:"databaseId"},{type:"string",name:"type"},{type:"string",name:"previewUrl"},{type:"string",name:"previewImg"},{type:"string",name:"datUrl"},{type:"string",name:"description"},{type:"number",name:"aspectRatio"},{type:"string",name:"videoUrl"}],inputComponent:function(e){var t,c=function(e){switch(e.type){case"VIDEO":return e.previewUrls[0];default:return e.files.webImage.url}},d=function(e){var t,r,n;return"VIDEO"===e.type?null!=(t=null==(r=e.files)||null==(n=r.original)?void 0:n.url)?t:e.previewUrls[0]:null},m=function(e){return e.height/e.width},g=e.value,f=e.type,v=e.markers,y=e.level,h=e.readOnly;return g&&("VIDEO"===g.type&&(t=r.createElement(u,{controls:!0,poster:g.previewImg,sources:[{src:g.previewUrl}]})),"IMAGE"===g.type&&(t=r.createElement("img",{alt:"preview",src:g.previewUrl,style:{maxWidth:"100%",height:"auto"}}))),r.createElement(s,{markers:v,legend:f.title,description:f.description,level:y},r.createElement("div",{style:{textAlign:"center"}},t),r.createElement(o,{align:"start"},r.createElement(l,{disabled:h,inverted:!0,title:"Select an asset",kind:"default",onClick:function(){var t=e.onChange,r=e.type,o=e.value,l={language:a.language||"en_US",portal:{url:a.portalDomain},theme:{colorPrimary:"#156dff",colorButtonPrimary:"#156dff"},mode:"SingleSelectFile",onSuccess:function(e){var a,l,s=e[0],u=s.files.webImage,g=m({width:u.width,height:u.height}),f={_key:null==o?void 0:o._key,_type:r.name,id:s.id,name:s.name,databaseId:s.databaseId,type:s.type,previewUrl:c(s),previewImg:u.url,datUrl:null==(a=s.files.transformBaseUrl)?void 0:a.url,videoUrl:d(s),description:s.description,aspectRatio:g};"VIDEO"===s.type?(l=u.url,new Promise((function(e,t){var r=new Image;r.onload=function(){e(m({width:r.width,height:r.height}))},r.onerror=function(e){return t(e)},r.src=l}))).then((function(e){t(i.from([n.set(p({},f,{aspectRatio:e}))]))})).catch((function(e){console.log("Error setting video aspect ratio:",e),t(i.from([n.set(f)]))})):t(i.from([n.set(f)]))}},s=r.options.assetTypes;s&&(l.assetTypes=s),function(e){var t=document.getElementById("bynder");if(!t){var r=document.createElement("script");r.src="https://ucv.bynder.com/5.0.5/modules/compactview/bynder-compactview-3-latest.js",r.id="bynder",document.body.appendChild(r),r.onload=function(){return!e||e()}}!t||!e||e()}((function(){window.BynderCompactView.open(l)}))}},"Browse"),r.createElement(l,{disabled:h||!g,color:"danger",inverted:!0,title:"Remove asset",onClick:function(){(0,e.onChange)(i.from([n.unset()]))}},"Remove")))},diffComponent:function(e){return r.createElement(d.DiffFromTo,{diff:e.diff,schemaType:e.schemaType,previewComponent:m})}};
//# sourceMappingURL=sanity-plugin-bynder-input.cjs.production.min.js.map
